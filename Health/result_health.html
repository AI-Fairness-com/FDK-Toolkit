<!DOCTYPE html>
<html>
<head>
    <title>Universal Health Fairness Audit - Results</title>
    <style>
        .container { max-width: 900px; margin: 40px auto; padding: 20px; }
        .success-card { background: #d4edda; padding: 30px; border-radius: 10px; margin: 25px 0; border-left: 5px solid #28a745; }
        .error-card { background: #f8d7da; padding: 30px; border-radius: 10px; margin: 25px 0; border-left: 5px solid #dc3545; }
        .summary-card { background: #e7f3ff; padding: 25px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #007bff; }
        .disclaimer-card { background: #fff3cd; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #ffc107; }
        .file-info { background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 15px 0; border: 1px solid #dee2e6; }
        .summary-content { background: white; padding: 25px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef; }
        .back-btn { background: #6c757d; color: white; padding: 12px 25px; border: none; border-radius: 5px; cursor: pointer; }
        .download-btn { background: #28a745; color: white; padding: 12px 25px; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px; }
        .filename { font-weight: bold; color: #2c3e50; font-size: 1.1em; }
        .report-path { color: #6c757d; font-size: 0.9em; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè• Universal Health Fairness Audit</h1>
        
        {% if title == "Health Fairness Audit Completed" %}
        <div class="success-card">
            <h2 style="color: #155724; margin-top: 0;">‚úÖ {{ title }}</h2>
            <p style="color: #155724; font-size: 1.1em;">{{ message }}</p>
        </div>

        <div class="file-info">
            <h3 style="color: #2c3e50; margin-top: 0;">üìÅ Dataset Information</h3>
            <p><span class="filename">{{ request.args.get('filename', 'Your uploaded dataset') }}</span></p>
            <p style="color: #6c757d; font-size: 0.9em;">
                ‚úÖ Comprehensive fairness analysis completed successfully
            </p>
        </div>

        <div class="summary-card">
            <h3 style="color: #0056b3; margin-top: 0;">üìä Audit Summary</h3>
            <div class="summary-content">
                {{ summary|safe }}
            </div>
        </div>

        {% if report_filename %}
        <div style="text-align: center; margin-top: 30px;">
            <!-- UPDATED: Changed to health_upload_page -->
            <a href="{{ url_for('health_upload_page') }}">
                <button class="back-btn">‚Üê Back to Health Upload</button>
            </a>
            <!-- UPDATED: Changed to download_health_report -->
            <a href="{{ url_for('download_health_report', filename=report_filename) }}">
                <button class="download-btn">üì• Download Full JSON Report</button>
            </a>
            <p class="report-path">Full technical report: {{ report_filename }}</p>
        </div>
        {% endif %}

        {% else %}
        <div class="error-card">
            <h2 style="color: #721c24; margin-top: 0;">‚ùå {{ title }}</h2>
            <p style="color: #721c24; font-size: 1.1em;">{{ message }}</p>
        </div>

        <div style="text-align: center; margin-top: 30px;">
            <!-- UPDATED: Changed to health_upload_page -->
            <a href="{{ url_for('health_upload_page') }}">
                <button class="back-btn">‚Üê Back to Health Upload</button>
            </a>
        </div>
        {% endif %}

        <div class="disclaimer-card">
            <h4 style="color: #856404; margin-top: 0;">‚ö†Ô∏è Important Disclaimer</h4>
            <p style="color: #856404; font-size: 0.9em; margin: 0;">
                This fairness audit complies with EU AI Act and UN AI Principles. This tool is for fairness assessment only and does not provide medical advice, diagnosis, or replace professional healthcare consultation. For medical concerns, always consult qualified healthcare professionals.
            </p>
        </div>
    </div>
</body>
</html>